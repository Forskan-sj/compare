var egret = window.egret;var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(a,o){function s(e){try{h(i.next(e))}catch(t){o(t)}}function r(e){try{h(i["throw"](e))}catch(t){o(t)}}function h(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(s,r)}h((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,o=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){h.label=n[1];break}if(6===n[0]&&h.label<s[1]){h.label=s[1],s=n;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(n);break}s[2]&&h.ops.pop(),h.trys.pop();continue}n=t.call(e,h)}catch(i){n=[6,i],o=0}finally{a=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,o,s,r,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.className_key="GamePetDocView",t.skinName="GamePetDocViewSkin",t}return __extends(t,e),t.prototype.enable=function(){e.prototype.enable.call(this),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.removeUs=function(){e.prototype.removeUs.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.init=function(){},t.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.touchHandle=function(e){switch(e.target){case this.closeBtn:this.removeUs(),this.destroy()}},t.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.destroy=function(){this.closeBtn.destroy()},t}(baseContent.BasePanel);e.GamePetDocView=t,__reflect(t.prototype,"game_pet.GamePetDocView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.className_key="GamePetInfoView",t.skinName="GamePetInfoViewSkin",t}return __extends(t,e),t.prototype.enable=function(){e.prototype.enable.call(this),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.init=function(){this.initEgg_animation()},t.prototype.initEgg_animation=function(){var e=this;if(!e.egg_animation){e.egg_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("egg_animation","MovieClip","egg_animation"),e.grpCenter.addChild(e.egg_animation),e.egg_animation.name="egg_animation",e.egg_animation.x=360,e.egg_animation.y=770,e.egg_animation.scaleX=e.egg_animation.scaleY=.75;var t=function(){egret.setTimeout(function(){e.egg_animation.animation.play("shake",1)},e,3e3)};e.egg_animation.addEventListener(egret.Event.COMPLETE,t,e)}e.egg_animation.animation.play("shake",1)},t.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.touchHandle=function(t){switch(t.target){case this.closeBtn:e.prototype.removeUsFromParent.call(this)}},t.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.egg_animation=null},t}(baseContent.BasePanel);e.GamePetInfoView=t,__reflect(t.prototype,"game_pet.GamePetInfoView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.num_=1,n.perNum_=1,n.className_key="GamePetEatSomeBayView",n.bayType="ttq",n.infos={ttq:{icon:"game_pet_tex_json.game_pet_ningshi_1_png",name:"甜甜圈",info:"吃个甜甜圈可以让宠物活跃4小时，宠物必须处在活跃的状态才能发挥作用",perNum:100},qz:{icon:"game_pet_tex_json.game_pet_qingzhi_1_png",name:"青汁",info:"让宠物瞬间获得50点经验，快速提升等级全靠它",perNum:100}},n.bayType=t,n.skinName="GamePetEatSomeBayViewSkin",n}return __extends(t,e),Object.defineProperty(t.prototype,"BayType",{get:function(){return this.bayType},set:function(e){this.bayType=e},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.initShow()},t.prototype.initShow=function(){this.showNumber&&(this.num_=1,this.iconImg.source=this.infos[this.bayType].icon,this.decBtn.source="panel_dyjs_content_json.panel_daojujianshe_bye_btn_jianhao_png","qz"==this.bayType?this.perNum_=game.GameDatas.getIntance().pet_infos.pet_pnvu_price:"ttq"==this.bayType&&(this.perNum_=game.GameDatas.getIntance().pet_infos.pet_snacks_price),this.showNumber.text=this.num_+"",this.buyNum.text=this.num_*this.perNum_+"",this.nameStr.text=this.infos[this.bayType].name,this.infoStr.text=this.infos[this.bayType].info)},t.prototype.enable=function(){e.prototype.enable.call(this),this.initShow(),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.decBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this)},t.prototype.touchHanle=function(e){switch(e.target){case this.closeBtn:this.removeUs();break;case this.addBtn:if(this.num_++,this.num_>10)return void(this.num_=10);10==this.num_?this.addBtn.source="panel_dyjs_content_json.panel_daojujianshe_bye_btn_jiahao1_png":this.addBtn.source="panel_dyjs_content_json.panel_daojujianshe_bye_btn_jiahao_png",this.showNumber.text=this.num_+"",this.buyNum.text=this.num_*this.perNum_+"",this.num_>1&&(this.decBtn.source="panel_daojujianshe_bye_btn_jianhao1_png");break;case this.decBtn:this.num_--,this.num_<=1&&(this.num_=1,this.decBtn.source="panel_dyjs_content_json.panel_daojujianshe_bye_btn_jianhao_png"),this.num_<10&&(this.addBtn.source="panel_dyjs_content_json.panel_daojujianshe_bye_btn_jiahao_png"),this.showNumber.text=this.num_+"",this.buyNum.text=this.num_*this.perNum_+"";break;case this.buyBtn:this.bayType,game.GameNetUrlData.isUseNet&&game.GameRequestMgr.getIntance().Pet_buyFoods_C("qz"==this.bayType?1:2,this.num_),this.removeUs()}},t.prototype.removeUs=function(){e.prototype.removeUs.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.addBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.decBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this),this.buyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHanle,this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.closeBtn.destroy()},t}(baseContent.BasePanel);e.GamePetEatSomeBayView=t,__reflect(t.prototype,"game_pet.GamePetEatSomeBayView",["baseContent.IPanel","baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.isChildCreated=!1,e.width=124,e.height=142,e.skinName="GamePetIconSkin",egret.setInterval(function(){},e,1e4),game.GameRequestMgr.getIntance().Pet_petLists_C(),e}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this;e.isChildCreated=!0,e.initShow(),e.initLvUp_animation(),e.expupImg.visible=e.lvupImg.visible=!1,e.addEvent()},n.prototype.initShow=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(n){return e=this,[2,new Promise(function(n){game.GameDatas.getIntance().pet_infos&&t.isChildCreated&&(game.GameDatas.getIntance().user_info&&game.GameDatas.getIntance().user_info.in_battle_pet_id?e.upDateInBattlePet(game.GameDatas.getIntance().user_info.in_battle_pet_id):e.upDateInBattlePet(0))})]})})},n.prototype.init_iconPet_animation=function(e){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(i){return t=this,[2,new Promise(function(i){if(t.iconPet_animation&&(t.iconPet_animation.removeEventListener(egret.Event.COMPLETE,n.playPetEnd,n),t.iconPet_animation.animation.isPlaying&&t.iconPet_animation.animation.stop(),t.iconPet_animation.parent&&t.iconPet_animation.parent.removeChild(t.iconPet_animation),t.iconPet_animation=null),t.iconPet_animation||(t.iconPet_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation(e,"Armature",e),t.animaGrp.addChildAt(t.iconPet_animation,0),t.iconPet_animation.name="iconPet_animation",t.iconPet_animation.scaleX=t.iconPet_animation.scaleY=.5,t.iconPet_animation.x=t.width/2,t.iconPet_animation.y=t.height),game.GameDatas.getIntance().user_info&&game.GameDatas.getIntance().user_info.in_battle_pet_id&&game.GameDatas.getIntance().pet_infos)for(var a=0,o=game.GameDatas.getIntance().pet_infos.pet_list.length;o>a;a++)game.GameDatas.getIntance().pet_infos.pet_list[a].pet_id==game.GameDatas.getIntance().user_info.in_battle_pet_id&&(game.GameDatas.getIntance().pet_infos.pet_list[a].left_time<=0?t.iconPet_animation.animation.play("sleep",1):t.iconPet_animation.animation.play("daily",1),t.iconPet_animation.addEventListener(egret.Event.COMPLETE,n.playPetEnd,t));else t.iconPet_animation.animation.play("daily",1),t.iconPet_animation.addEventListener(egret.Event.COMPLETE,n.playPetEnd,t)})]})})},n.prototype.playPetEnd=function(){var e=this;if(game.GameDatas.getIntance().user_info&&game.GameDatas.getIntance().user_info.in_battle_pet_id&&game.GameDatas.getIntance().pet_infos)for(var t=0,n=game.GameDatas.getIntance().pet_infos.pet_list.length;n>t;t++)game.GameDatas.getIntance().pet_infos.pet_list[t].pet_id==e.showPetId&&(game.GameDatas.getIntance().pet_infos.pet_list[t].left_time<=0?e.iconPet_animation.animation.play("sleep",1):e.iconPet_animation.animation.play("daily",1))},n.prototype.initLvUp_animation=function(){var e=this;e.lvup_animation||(e.lvup_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("lvup_animation","Armature","lvup_animation"),e.animaGrp.addChild(e.lvup_animation),e.lvup_animation.name="lvup_animation",e.lvup_animation.x=62,e.lvup_animation.y=170,e.lvup_animation.scaleX=e.lvup_animation.scaleY=.5,e.lvup_animation.addEventListener(egret.Event.COMPLETE,e.playLvUpAnimationEnd,e)),e.lvup_animation.visible=!1},n.prototype.playLvUpAnimation=function(e){if(game.GameDatas.getIntance().user_info.in_battle_pet_id){var t=this;t.lvup_animation.visible=!0,t.lvup_animation.animation.play("lvup",1),e&&egret.setTimeout(function(){t.lvupImg.y=30,t.lvupImg.visible=!0,egret.Tween.get(t.lvupImg).to({y:-30},300,egret.Ease.sineIn).wait(200).call(function(){t.lvupImg.visible=!1},t)},t,200),t.expupImg.y=30,t.expupImg.visible=!0,egret.Tween.get(t.expupImg).to({y:-30},300,egret.Ease.sineIn).wait(200).call(function(){t.expupImg.visible=!1},t)}},n.prototype.playLvUpAnimationEnd=function(){this.lvup_animation.visible=!1},n.prototype.upDateInBattlePet=function(e){return void 0===e&&(e=0),__awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return t=this,t.showPetId==e?[2]:(t.showPetId=e,t.iconShow.visible=!1,1==e?t.init_iconPet_animation("kuilin_animation"):2==e?t.init_iconPet_animation("hafei_animation"):(t.iconPet_animation&&(t.iconPet_animation.removeEventListener(egret.Event.COMPLETE,this.playPetEnd,this),t.iconPet_animation.animation.isPlaying&&t.iconPet_animation.animation.stop(),t.iconPet_animation.parent&&t.iconPet_animation.parent.removeChild(t.iconPet_animation),t.iconPet_animation=null),t.iconPet_animation||(t.iconPet_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("egg_animation","MovieClip","egg_animation"),t.animaGrp.addChildAt(t.iconPet_animation,0),t.iconPet_animation.name="iconPet_animation",t.iconPet_animation.scaleX=t.iconPet_animation.scaleY=.5,t.iconPet_animation.x=this.width/2,t.iconPet_animation.y=this.height),t.iconPet_animation.animation.play("shake")),[2])})})},n.prototype.addEvent=function(){commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.goToBattlSucc,this.upDateInBattlePet,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetLvUpAnimation,this.playLvUpAnimation,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petUpgradeEvent,this.playLvUpAnimation,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.enterPetView,this.touchHandle,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(){var t=this;if(baseContent.SceneLayerMgr.getIntance().getCurrenScene().randPanel.isEnd){console.log("进入宠物系统");for(var n=game.GameDatas.getIntance().iconList,i=0,a=n.length;a>i;i++)if("petBtn"==n[i].icon_name&&game.GameDatas.getIntance().user_info.max_star_num<n[i].enable_star_num)return void baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetInfoView);game.GameRequestMgr.getIntance().Pet_petLists_C(),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!0),baseContent.BufferLayerMgr.getIntance().addBuffer("game.GameServerLoadingView"),commonUtils.ResUtils.getInstance().loadGroupByGrpArr([game.GameDatas.game_pet],null,function(){baseContent.BufferLayerMgr.getIntance().removeBuffer("game.GameServerLoadingView"),egret.setTimeout(function(){game.GameDatas.getIntance().pet_infos&&baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetView),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowChaoPing,!1),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowMainView,!1),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!1)},t,750)},this)}},n}(eui.Component);e.GamePetIcon=t,__reflect(t.prototype,"game_pet.GamePetIcon")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.width=720,t.height=190,t.skinName="GamePetInfoStatusOneSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.changeData=function(e){this.petInfo_=e,this.infoText&&this.initShow()},t.prototype.init=function(){this.petInfo_&&this.initShow(),this.addEvent()},t.prototype.initShow=function(){var e=this,t=[];t=[{text:"技能：",style:{size:22,textColor:"0xFFE22A",fontFamily:"Microsoft YaHei"}},{text:e.petInfo_.skill,style:{size:22,textColor:"0xffffff",fontFamily:"Microsoft YaHei"}}],e.infoText.textFlow=t,e.yaoBtn.textShow.text=e.petInfo_.inviting_times+"/"+e.petInfo_.inviting_need_times,e.huoBtn.glodShow.text=""+e.petInfo_.barley_num,e.changeShowLastTime(),e.lastTimerKey&&egret.clearInterval(e.lastTimerKey),e.lastTimerKey=egret.setInterval(e.changeShowLastTime,e,1e3)},t.prototype.changeShowLastTime=function(){for(var e=!0,t=0,n=game.GameDatas.getIntance().pet_infos.pet_list.length;n>t;t++)game.GameDatas.getIntance().pet_infos.pet_list[t].hatch_left_time>0&&(e=!1,game.GameDatas.getIntance().pet_infos.pet_list[t].hatch_left_time-=1,game.GameDatas.getIntance().pet_infos.pet_list[t].pet_id==this.petInfo_.pet_id&&(this.huoBtn.timeShow.text=commonUtils.NumberTool.getShowTimeTwo(game.GameDatas.getIntance().pet_infos.pet_list[t].hatch_left_time)+"后免费"));e&&(this.huoBtn.timeShow.text="免费开启",egret.clearInterval(this.lastTimerKey))},t.prototype.addEvent=function(){this.yaoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.huoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.touchHandle=function(e){switch(e.target){case this.yaoBtn:if(egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME){if(this.petInfo_.inviting_times>=this.petInfo_.inviting_need_times){commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetViewUpOnePet,1);break}game.WXTools.sharSomeMessage({title:"这个风景真好，好想把它踹下去！",imageUrl:"https://cdngame.quansuwangluo.com/game/romote/shareimg/share_img_4.jpg",query:"user_id="+game.GameDatas.getIntance().user_info.id+"&share_type=game_pet_wan_cheng",success:function(e){console.log("宠物 分享成功！"),game.GameRequestMgr.getIntance().Share_sharedSuccess_C("game_pet_wan_cheng")}},platform);break}viewTool.TipsUtil.getIntance().showTip("请在微信中打开！");break;case this.huoBtn:for(var t=0,n=game.GameDatas.getIntance().pet_infos.pet_list.length;n>t;t++)if(game.GameDatas.getIntance().pet_infos.pet_list[t].hatch_left_time<=0)return void commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetViewUpOnePet,1);game.GameDatas.getIntance().user_info.barley_num>=this.petInfo_.barley_num?commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetViewUpOnePet,3):viewTool.TipsUtil.getIntance().showTip("金币不足！")}},t}(eui.Component);e.GamePetInfoStatusOne=t,__reflect(t.prototype,"game_pet.GamePetInfoStatusOne")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.width=720,e.height=190,e.skinName="GamePetInfoStatusThreeSkin",e}return __extends(n,t),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},n.prototype.changeData=function(e){this.petInfo_=e,this.infoText&&this.initShow()},n.prototype.init=function(){this.petInfo_&&this.initShow(),this.addEvent()},n.prototype.initShow=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return e=this,[4,e.showBarInfo()];case 1:return t=n.sent(),t?[2,new Promise(function(t){e.levText.text="LV."+e.petInfo_.level;var n=[];if(n=[{text:"技能：",style:{size:22,textColor:"0xFFE22A",fontFamily:"Microsoft YaHei"}},{text:e.petInfo_.skill,style:{size:22,textColor:"0xffffff",fontFamily:"Microsoft YaHei"}}],e.infoText.textFlow=n,e.currText.text=e.petInfo_.current_rate+"%",0==e.petInfo_.next_rate){e.barImg.visible=!0;var i=358;egret.Tween.get(e.barImg).to({width:i},300,egret.Ease.sineIn),e.lvMax.visible=!0,e.barInfoText.visible=e.nextText.visible=e.nextTitle.visible=!1}else e.lvMax.visible=!1,e.barInfoText.visible=e.nextText.visible=e.nextTitle.visible=!0;e.nextText.text=e.petInfo_.next_rate+"%",e.petInfo_.is_activity?(e.lastTimerKey&&egret.clearInterval(e.lastTimerKey),e.showSomePetIdTime(e.petInfo_.pet_id),e.lastTimerKey=egret.setInterval(e.updateLeftTimeShow,e,1e3)):(e.lastTimerKey&&egret.clearInterval(e.lastTimerKey),e.statusInfo.text="未开启")})]:[2]}})})},n.prototype.showSomePetIdTime=function(e){for(var t=0,n=game.GameDatas.getIntance().pet_infos.pet_list.length;n>t;t++)e==game.GameDatas.getIntance().pet_infos.pet_list[t].pet_id&&(game.GameDatas.getIntance().pet_infos.pet_list[t].left_time<1?this.statusInfo.text="未开启":this.statusInfo.text=commonUtils.NumberTool.getShowTimeTwo(game.GameDatas.getIntance().pet_infos.pet_list[t].left_time))},n.prototype.updateLeftTimeShow=function(){for(var e=!0,t=0,n=game.GameDatas.getIntance().pet_infos.pet_list.length;n>t;t++)game.GameDatas.getIntance().pet_infos.pet_list[t].left_time>0&&(e=!1,game.GameDatas.getIntance().pet_infos.pet_list[t].left_time-=1,commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetDaliyOrSeep,game.GameDatas.getIntance().pet_infos.pet_list[t].pet_id,game.GameDatas.getIntance().pet_infos.pet_list[t]),this.petInfo_.pet_id==game.GameDatas.getIntance().pet_infos.pet_list[t].pet_id&&(game.GameDatas.getIntance().pet_infos.pet_list[t].left_time<1?this.statusInfo.text="未开启":this.statusInfo.text=commonUtils.NumberTool.getShowTimeTwo(game.GameDatas.getIntance().pet_infos.pet_list[t].left_time),baseContent.SceneLayerMgr.getIntance().getCurrenScene()&&baseContent.SceneLayerMgr.getIntance().getCurrenScene().petBtn&&baseContent.SceneLayerMgr.getIntance().getCurrenScene().petBtn.initShow()));e&&this.lastTimerKey&&egret.clearInterval(this.lastTimerKey)},n.prototype.showBarInfo=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e=this,[2,new Promise(function(t){if(0==e.petInfo_.current_EXP)return e.barImg.visible=!1,e.barInfoText.text=e.petInfo_.current_EXP+"/"+e.petInfo_.upgrage_EXP,void t(!0);e.barImg.visible=!0;var n=e.petInfo_.current_EXP/e.petInfo_.upgrage_EXP;n=n>1?1:n;var i=332*n+26;egret.Tween.get(e.barImg).to({width:i},300,egret.Ease.sineIn).call(function(){t(!0)},e),e.barInfoText.text=e.petInfo_.current_EXP+"/"+e.petInfo_.upgrage_EXP})]})})},n.prototype.addEvent=function(){this.docBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(t){switch(t.target){case this.docBtn:baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetDocView)}},n}(eui.Component);e.GamePetInfoStatusThree=t,__reflect(t.prototype,"game_pet.GamePetInfoStatusThree")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.hatch_type_=1,t.width=720,t.height=190,t.skinName="GamePetInfoStatusTwoSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.changeData=function(e){this.petInfo_=e,this.infoText&&this.initShow()},Object.defineProperty(t.prototype,"hatch_type",{get:function(){return this.hatch_type_},set:function(e){this.hatch_type_=e},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.petInfo_&&this.initShow(),this.addEvent()},t.prototype.initShow=function(){var e=this,t=[];t=[{text:"技能：",style:{size:22,textColor:"0xFFE22A",fontFamily:"Microsoft YaHei"}},{text:e.petInfo_.skill,style:{size:22,textColor:"0xffffff",fontFamily:"Microsoft YaHei"}}],e.infoText.textFlow=t},t.prototype.addEvent=function(){this.fuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.touchHandle=function(e){switch(e.target){case this.fuBtn:commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.petFuHuaEvent,{pet_id:this.petInfo_.pet_id,hatch_type:this.hatch_type_})}},t}(eui.Component);e.GamePetInfoStatusTwo=t,__reflect(t.prototype,"game_pet.GamePetInfoStatusTwo")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(){function e(){}return e}();e.PetInfo=t,__reflect(t.prototype,"game_pet.PetInfo")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.className_key="GamePetActionView",n.gamePetId=t,n.skinName="GamePetActionViewSkin",n}return __extends(t,e),t.prototype.enable=function(){e.prototype.enable.call(this),this.showImg&&this.showEnterImg()},t.prototype.showEnterImg=function(){switch(this.gamePetId){case 1:this.showImg.source="game_pet_img_kuiling_png";break;case 2:this.showImg.source="game_pet_img_hafei_png"}this.showImg.scaleX=this.showImg.scaleY=.2;var e=new egret.Point(this.rightImg.x,this.rightImg.y),t=new egret.Point(this.leftImg.x,this.leftImg.y),n=this.getPoints(e,t,600);this.rightImg.x=n[0].x,this.rightImg.y=n[0].y,this.leftImg.x=n[1].x,this.leftImg.y=n[1].y,egret.Tween.get(this.rightImg).to({x:e.x,y:e.y},200,egret.Ease.bounceOut),egret.Tween.get(this.leftImg).to({x:t.x,y:t.y},200,egret.Ease.bounceOut),egret.Tween.get(this.showImg).to({scaleX:1,scaleY:1},150,egret.Ease.sineIn)},t.prototype.getPoints=function(e,t,n){var i=[],a=Math.abs(e.y-t.y),o=Math.abs(e.x-t.x),s=Math.sqrt(a*a+o*o),r=a/s*n,h=o/s*n;return i.push(new egret.Point(e.x+h,e.y-r)),i.push(new egret.Point(t.x-h,t.y+r)),console.log(e,t),console.log(i),i},t.prototype.removeUs=function(){e.prototype.removeUs.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.init=function(){this.showEnterImg()},t.prototype.addEvent=function(){egret.setTimeout(this.destroy,this,500)},t.prototype.removeEvent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(baseContent.BasePanel);e.GamePetActionView=t,__reflect(t.prototype,"game_pet.GamePetActionView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(e,n){var i=t.call(this)||this;return i.eggPlayEnd=!0,i.petInfoConfig=n,i.petInfo=e,i.skinName="GamePetItemViewSkin",i}return __extends(n,t),Object.defineProperty(n.prototype,"petInfo_",{get:function(){return this.petInfo},set:function(e){this.petInfo=e,this.init()},enumerable:!0,configurable:!0}),n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initEgg_animation(),this.init_iconPet_animation(),this.initLvUp_animation(),this.init(),this.addEvent()},n.prototype.init=function(){this.index=0,this.petInfo&&this.initShow(this.petInfo)},n.prototype.showSomeOneMsg=function(e){this.msgGrp.scaleX=this.msgGrp.scaleY=0,this.msgGrp.visible=!0,"ttq"==e?(this.infoMsg.text="我饿了，想吃甜甜圈",this.iconMsg.source="game_pet_tex_json.game_pet_ningshi_0_png"):(this.infoMsg.text="我渴了，想喝杯青汁",this.iconMsg.source="game_pet_tex_json.game_pet_qingzhi_0_png"),egret.Tween.get(this.msgGrp).to({scaleX:1,scaleY:1},300,egret.Ease.bounceOut)},n.prototype.init_iconPet_animation=function(){var e=this;if(!e.iconPet_animation){e.iconPet_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation(e.petInfoConfig.source,"Armature",e.petInfoConfig.source),e.allGrp.addChild(e.iconPet_animation),e.iconPet_animation.name="iconPet_animation",e.iconPet_animation.x=this.allGrp.width/2,e.iconPet_animation.y=570;var t=function(){e.petInfo_.left_time>0?(e.playPetAnimationAction("daily"),e.msgGrp.visible=!1):(e.playPetAnimationAction("sleep"),e.petInfo.statu<2?e.msgGrp.visible=!1:e.msgGrp.visible=!0)};e.iconPet_animation.addEventListener(egret.Event.COMPLETE,t,e)}e.iconPet_animation.visible=!1},n.prototype.initLvUp_animation=function(){var e=this;e.lvup_animation||(e.lvup_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("lvup_animation","Armature","lvup_animation"),e.allGrp.addChild(e.lvup_animation),e.lvup_animation.name="lvup_animation",e.lvup_animation.x=this.allGrp.width/2,e.lvup_animation.y=600,e.lvup_animation.addEventListener(egret.Event.COMPLETE,e.playLvUpAnimationEnd,e)),e.lvup_animation.visible=!1},n.prototype.playLvUpAnimation=function(){this.lvup_animation.visible=!0,this.lvup_animation.animation.play("lvup",1)},n.prototype.playLvUpAnimationEnd=function(){this.lvup_animation.visible=!1},n.prototype.initEgg_animation=function(){var e=this;e.egg_animation||(e.egg_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("egg_animation","MovieClip","egg_animation"),e.allGrp.addChild(e.egg_animation),e.egg_animation.name="egg_animation",e.egg_animation.x=this.allGrp.width/2,e.egg_animation.y=600,e.egg_animation.addEventListener(egret.Event.COMPLETE,e.eggAnimationEnd,e)),e.egg_animation.animation.play("shake",1),e.egg_animation.visible=!1,e.egg_animation.touchEnabled=!0},n.prototype.eggAnimationEnd=function(){var e=this;e.eggPlayEnd=!0,e.keyTimeOut=egret.setTimeout(function(){e.egg_animation.animation.play("shake",1)},e,3e3)},n.prototype.showFuHuaAnimation=function(){var t=this;if(t.eventFuHua&&t.eggPlayEnd){var n=t.eventFuHua;if(t.petInfo_.pet_id==n.pet_id)switch(t.index+=1,t.egg_animation.animation.stop(),egret.clearTimeout(t.keyTimeOut),t.eggPlayEnd=!1,t.index){case 1:t.egg_animation.animation.play("one",1);break;case 2:t.egg_animation.animation.play("two",1);break;case 3:t.egg_animation.animation.play("three",1),t.eventFuHua=null,game.GameRequestMgr.getIntance().Pet_petHatch_C(n.pet_id,n.hatch_type);var i=function(){t.egg_animation.removeEventListener(egret.Event.COMPLETE,i,t),baseContent.SceneLayerMgr.getIntance().getCurrenScene().initShow();var n=baseContent.PanelManager.getIntance().getPenelByPanelKey("GamePetView");n&&game.GameDatas.getIntance().fuhuaPetInfo&&n.fuHuaSecc(game.GameDatas.getIntance().fuhuaPetInfo),baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetObjInfoView,{petName:game.GameDatas.getIntance().fuhuaPetInfo.name,skillInfo:game.GameDatas.getIntance().fuhuaPetInfo.skill,petId:game.GameDatas.getIntance().fuhuaPetInfo.pet_id})};t.egg_animation.addEventListener(egret.Event.COMPLETE,i,t)}}},n.prototype.showFuHua=function(e){this.petInfo_.pet_id==e.pet_id&&(this.eventFuHua=e,this.openFuHuaView())},n.prototype.showFuHuaEnd=function(e){this.petInfo_.pet_id==e.pet_id&&this.closeFuHuaView()},n.prototype.openFuHuaView=function(){egret.Tween.get(this.landImg).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.recImg).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.egg_animation).to({scaleX:1.4,scaleY:1.4},500,egret.Ease.bounceInOut)},n.prototype.closeFuHuaView=function(){egret.Tween.get(this.landImg).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.recImg).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.egg_animation).to({scaleX:1,scaleY:1},500,egret.Ease.bounceInOut)},n.prototype.initShow=function(e){var t=this;t.petInfo.statu<2?(t.iconPet_animation.visible=!1,t.egg_animation.visible=!0,t.msgGrp.visible=!1):(t.petInfo_.left_time>0?(t.playPetAnimationAction("daily"),t.msgGrp.visible=!1):(t.playPetAnimationAction("sleep"),t.petInfo.statu<2?t.msgGrp.visible=!1:t.msgGrp.visible=!0),t.iconPet_animation.visible=!0,t.egg_animation.visible=!1)},n.prototype.playPetAnimationAction=function(e){var t=this;t.iconPet_animation.animation.isPlaying&&t.iconPet_animation.animation.stop(),t.iconPet_animation.animation.play(e,1)},n.prototype.goToBattlSuccCall=function(e){e==this.petInfo_.pet_id&&(this.playLvUpAnimation(),console.log(this.petInfo_.name+"上阵---"))},n.prototype.addEvent=function(){commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petUpgradeEvent,this.petUpgradeEventCall,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petFuHuaEvent,this.showFuHua,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petFuHuaEndEvent,this.showFuHuaEnd,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.goToBattlSucc,this.goToBattlSuccCall,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetViewEatingSucc,this.eatSucc,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetDaliyOrSeep,this.changeShow,this),this.egg_animation.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showFuHuaAnimation,this)},n.prototype.changeShow=function(e,t){this.petInfo_.pet_id==e&&this.petInfo_.left_time>0!=t.left_time>0&&(this.petInfo=t,this.petInfo_.left_time>0?(this.playPetAnimationAction("daily"),this.msgGrp.visible=!1):(this.playPetAnimationAction("sleep"),this.petInfo.statu<2?this.msgGrp.visible=!1:this.msgGrp.visible=!0))},n.prototype.eatSucc=function(e,t,n){e==this.petInfo_.pet_id&&(this.playLvUpAnimation(),this.petInfo=t,console.log(this.petInfo.name+"喂食成功---"))},n.prototype.petUpgradeEventCall=function(e){e==this.petInfo_.pet_id&&(this.playLvUpAnimation(),console.log(this.petInfo_.name+"升级---"))},n}(eui.Component);e.GamePetItemView=t,__reflect(t.prototype,"game_pet.GamePetItemView")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.isCreate=!1,e.className_key="GamePetView",e.petInfos=[{id:1,name:"奎林",icon:"game_pet_img_kuiling_png",nameStr:"game_pet_tex_json.game_pet_text_kuiling_png",source:"kuilin_animation",info:""},{id:2,name:"哈菲",icon:"game_pet_img_hafei_png",nameStr:"game_pet_tex_json.game_pet_text_hafei_png",source:"hafei_animation",info:""}],e.indexSelect=0,e.skinName="GamePetViewSkin",e}return __extends(n,t),n.prototype.getSomeConfigById=function(e){for(var t=0,n=this.petInfos.length;n>t;t++)if(this.petInfos[t].id==e)return this.petInfos[t];return null},n.prototype.init=function(){commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetConstrolEvent,e.GamePetStepType.barInfoView),game.GameDatas.getIntance().pet_infos&&(this.initShowSomePet(),this.showIconNum()),this.leftBtn.enabled=!1,this.addEvent(),this.isCreate=!0
},n.prototype.showIconNum=function(){var e=game.GameDatas.getIntance().pet_infos;e&&(this.qzBtn.textShow.text=e.pet_pnvu+"",this.ttqBtn.textShow.text=e.pet_snacks+"")},n.prototype.eatSucc=function(e,t,n){console.log("喂食成功"),this.upDateShowInfo()},n.prototype.initShowSomePet=function(){this.textImg.source=this.petInfos[this.indexSelect].nameStr;for(var t=game.GameDatas.getIntance().pet_infos,n=0,i=t.pet_list.length;i>n;n++){var a=void 0;n<this.listGrp.numChildren?(a=this.listGrp.getChildAt(n),a.initShow(t.pet_list[n])):(a=new e.GamePetItemView(t.pet_list[n],this.petInfos[n]),this.listGrp.addChild(a)),a.horizontalCenter=700*n,a.verticalCenter=-45}this.upDateShowInfo()},n.prototype.enable=function(){t.prototype.enable.call(this),this.rectImg.visible=!1,this.headGrp.top=-this.headGrp.height,this.isCreate&&(this.initShowSomePet(),this.showIconNum()),egret.setTimeout(this.showHeadInfoDownAnimation,this,350)},n.prototype.fuHuaSecc=function(e){console.log("孵化成功-->"+e);for(var t=0,n=this.listGrp.numChildren;n>t;t++){var i=this.listGrp.getChildAt(t);i.petInfo_.pet_id==e.pet_id&&(i.petInfo_=e)}this.upDateShowInfo()},n.prototype.showHeadInfoDownAnimation=function(){egret.Tween.get(this.headGrp).to({top:0},500,egret.Ease.bounceOut)},n.prototype.showHeadInfoUpAnimation=function(){egret.Tween.get(this.headGrp).to({top:-this.headGrp.height},500,egret.Ease.sineIn)},n.prototype.openLeftBtnGrpAnimation=function(){egret.Tween.get(this.leftGrp).to({left:0},500,egret.Ease.bounceOut)},n.prototype.closeLeftBtnGrpAnimation=function(){egret.Tween.get(this.leftGrp).to({left:-this.leftGrp.width},500,egret.Ease.sineIn)},n.prototype.showFuHua=function(e){this.showHeadInfoUpAnimation(),this.closeLeftBtnGrpAnimation(),egret.Tween.get(this.backBtn).to({left:-this.backBtn.width},500,egret.Ease.sineIn),egret.Tween.get(this.leftBtn).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.rightBtn).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.upBtn).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.infos.two).to({alpha:0},500,egret.Ease.sineIn),egret.Tween.get(this.infos.three).to({alpha:0},500,egret.Ease.sineIn)},n.prototype.showFuHuaEnd=function(e){this.showHeadInfoDownAnimation(),this.openLeftBtnGrpAnimation(),egret.Tween.get(this.backBtn).to({left:0},500,egret.Ease.sineIn),egret.Tween.get(this.leftBtn).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.rightBtn).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.upBtn).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.infos.two).to({alpha:1},500,egret.Ease.sineIn),egret.Tween.get(this.infos.three).to({alpha:1},500,egret.Ease.sineIn)},n.prototype.addEvent=function(){commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petFuHuaEvent,this.showFuHua,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.petFuHuaEndEvent,this.showFuHuaEnd,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetViewIconNumChange,this.showIconNum,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetViewEatingSucc,this.eatSucc,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetViewUpOnePet,this.changeInfoForFuHua,this),commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.goToBattlSucc,this.goToBattlSucc,this),this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.qzBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.ttqBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.removeEvent=function(){commonUtils.EventMananger.getIntance().removeEvent(game.GameEvent.gamePetViewIconNumChange,this.showIconNum,this),commonUtils.EventMananger.getIntance().removeEvent(game.GameEvent.gamePetViewEatingSucc,this.eatSucc,this),commonUtils.EventMananger.getIntance().removeEvent(game.GameEvent.gamePetViewUpOnePet,this.changeInfoForFuHua,this),commonUtils.EventMananger.getIntance().removeEvent(game.GameEvent.goToBattlSucc,this.goToBattlSucc,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.qzBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.ttqBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.leftBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.rightBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.upBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(t){var n=this;switch(t.target){case this.backBtn:commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!0),egret.setTimeout(function(){commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowChaoPing,!0),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowMainView,!0),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!1),n.removeUsFromParent()},this,750);break;case this.qzBtn:if(game.GameDatas.getIntance().pet_infos.pet_pnvu>0){game.GameRequestMgr.getIntance().Pet_petWater_C(this.currentInfo.pet_id);break}var i=baseContent.PanelManager.getIntance().getPenelByPanelKey("GamePetEatSomeBayView");i&&(i.BayType="qz"),baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetEatSomeBayView,"qz");break;case this.ttqBtn:if(game.GameDatas.getIntance().pet_infos.pet_snacks>0){game.GameRequestMgr.getIntance().Pet_petCookie_C(this.currentInfo.pet_id);break}var a=baseContent.PanelManager.getIntance().getPenelByPanelKey("GamePetEatSomeBayView");a&&(a.BayType="ttq"),baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetEatSomeBayView,"ttq");break;case this.leftBtn:this.changeScrllView(!1);break;case this.rightBtn:this.changeScrllView(!0);break;case this.upBtn:game.GameRequestMgr.getIntance().Pet_goToBattle_C(this.currentInfo.pet_id)}},n.prototype.upDateShowInfo=function(){if(this.upBtn){if(!this.infos){this.infos={};var t=new e.GamePetInfoStatusOne;t.horizontalCenter=0,t.bottom=140,t.name="info",this.infos.one=t;var n=new e.GamePetInfoStatusTwo;n.horizontalCenter=0,n.bottom=140,n.name="info",this.infos.two=n;var i=new e.GamePetInfoStatusThree;i.horizontalCenter=0,i.bottom=140,i.name="info",this.infos.three=i}switch(this.currentInfo=game.GameDatas.getIntance().pet_infos.pet_list[this.indexSelect],this.currentInfo.statu){case 0:this.upBtn.visible=!1,this.addSomeOneType(this.infos.one,this.currentInfo);break;case 1:this.upBtn.visible=!1,this.infos.two.hatch_type=1,this.addSomeOneType(this.infos.two,this.currentInfo);break;case 2:this.upBtn.visible=this.upBtn.enabled=!0,this.addSomeOneType(this.infos.three,this.currentInfo);break;case 3:this.upBtn.visible=!0,this.upBtn.enabled=!1,this.addSomeOneType(this.infos.three,this.currentInfo)}}},n.prototype.addSomeOneType=function(e,t){var n=this.allGrp.getChildByName("info");n&&this.allGrp.removeChild(n),this.allGrp.addChildAt(e,this.allGrp.numChildren-1),e.changeData(t)},n.prototype.changeInfoForFuHua=function(e){this.infos.two.hatch_type=e,this.addSomeOneType(this.infos.two,this.currentInfo)},n.prototype.goToBattlSucc=function(e){console.log("上阵宠物ID->"+e),this.upDateShowInfo()},n.prototype.changeScrllView=function(e){e?(this.indexSelect+=1,this.indexSelect==this.petInfos.length-1?this.rightBtn.enabled=!1:this.rightBtn.enabled=!0,this.indexSelect>0&&(this.leftBtn.enabled=!0)):(this.indexSelect-=1,0==this.indexSelect?(console.log("左侧没有了"),this.leftBtn.enabled=!1):this.leftBtn.enabled=!0,this.indexSelect<this.petInfos.length&&(this.rightBtn.enabled=!0)),this.upDateShowInfo(),egret.Tween.get(this.scrollerView.viewport).to({scrollH:700*this.indexSelect},300,egret.Ease.sineIn),this.textImg.source=this.petInfos[this.indexSelect].nameStr},n}(baseContent.BasePanel);e.GamePetView=t,__reflect(t.prototype,"game_pet.GamePetView",["baseContent.IPanel","baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;t.className_key="NewControlView",t.container=new egret.DisplayObjectContainer;var n=new egret.Shape;return n.graphics.beginFill(0,.55),n.graphics.drawRect(0,0,commonUtils.StageUtils.getIntance().stage.stageWidth,commonUtils.StageUtils.getIntance().stage.stageHeight),n.graphics.endFill(),t.container.addChild(n),t.dp=new egret.Shape,t.container.addChild(t.dp),t.dp.blendMode=egret.BlendMode.ERASE,t.bitmap=new egret.Bitmap,t.bitmap.touchEnabled=!0,t.bitmap.pixelHitTest=!0,t.addChild(t.bitmap),t.bitmap.name="bitmap",t.showHadC(),t.touchEnabled=!1,t.showTitleC=new game.NewControlShowTileContentView,t.touchGrp=new eui.Group,t.addChild(t.touchGrp),t.touchGrp.top=t.touchGrp.bottom=t.touchGrp.left=t.touchGrp.right=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"dp",{get:function(){return this._dp},set:function(e){this._dp=e},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.addSomeOneOrRemove=function(e,t,n){if(n){if(t.parent==e)return;e.addChild(t)}else{if(t.parent!=e)return;e.removeChild(t)}},t.prototype.initShow=function(e,t){if(void 0===t&&(t=!0),e.parent){var n=e.width>e.height?e.width:e.height;n/=2;var i=new egret.Point;i=e.parent.localToGlobal(e.x,e.y,i),this.dp.graphics.clear(),this.dp.graphics.beginFill(0,1),this.dp.graphics.drawCircle(e.width/2,e.height/2,n),this.dp.graphics.endFill(),this.dp.x=i.x,this.dp.y=i.y,this.showHad.x=i.x+e.width/2,this.showHad.y=i.y+e.height/2,t?this.showHad.scaleX=-1:this.showHad.scaleX=1;var a=new egret.RenderTexture;a.drawToTexture(this.container),this.bitmap.texture=a}},t.prototype.initShowPointCircle=function(e,t,n){void 0===n&&(n=!0);var i=this;game.NewControlViewMgr.getIntance().touchEnabledRect=!1,i.dp.graphics.clear(),i.dp.graphics.beginFill(0,1),i.dp.graphics.drawCircle(t/2,t/2,t),i.dp.graphics.endFill(),i.dp.x=e.x-t/2,i.dp.y=e.y-t/2,i.showHad.x=e.x,i.showHad.y=e.y,n?i.showHad.scaleX=-1:i.showHad.scaleX=1;var a=new egret.RenderTexture;a.drawToTexture(i.container),i.bitmap.texture=a,i.bitmap.alpha=0,egret.Tween.get(i.bitmap).to({alpha:1},300)},t.prototype.initShowPointRect=function(e,t,n,i,a,o){void 0===i&&(i=!0),void 0===a&&(a=!1),void 0===o&&(o=1);var s=this;game.NewControlViewMgr.getIntance().touchEnabledRect=!1,s.touchGrp.touchEnabled=a,s.dp.graphics.clear(),s.dp.graphics.beginFill(0,1),s.dp.graphics.drawRect(0,0,commonUtils.StageUtils.getIntance().stage.stageWidth,n),s.dp.graphics.endFill(),s.dp.x=0,s.dp.y=t,s.showHad.x=e.x,s.showHad.y=e.y,i?s.showHad.scaleX=-1:s.showHad.scaleX=1;var r=new egret.RenderTexture;r.drawToTexture(s.container),s.bitmap.texture=r,console.log("透明的效果-->"+o),0==o&&o+""=="0"?s.bitmap.alpha=0:(s.bitmap.alpha=0,egret.Tween.get(s.bitmap).to({alpha:1},300))},t.prototype.initShowPointRectTypeOfPoint=function(e,t,n,i,a,o,s,r){void 0===o&&(o=!0),void 0===s&&(s=!1),void 0===r&&(r=1);var h=this;game.NewControlViewMgr.getIntance().touchEnabledRect=!1,h.touchGrp.touchEnabled=s,h.dp.graphics.clear(),h.dp.graphics.beginFill(0,1),h.dp.graphics.drawRect(0,0,i,a),h.dp.graphics.endFill(),h.dp.x=t,h.dp.y=n,h.showHad.x=e.x,h.showHad.y=e.y,o?h.showHad.scaleX=-1:h.showHad.scaleX=1;var g=new egret.RenderTexture;g.drawToTexture(h.container),h.bitmap.texture=g,console.log("透明的效果-->"+r),0==r&&r+""=="0"?h.bitmap.alpha=0:(h.bitmap.alpha=0,egret.Tween.get(h.bitmap).to({alpha:1},300))},t.prototype.initShowTitle=function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=0),void 0===n&&(n="点击任意位置继续"),this.showTitleC.showSomeTitle(e,t,n)},t.prototype.showHadC=function(){var e=this;if(!e.showHad){e.showHad=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("a","tutorialhand","tutorialhand"),e.showHad.name="a",e.showHad.x=commonUtils.StageUtils.getIntance().stage.stageWidth/2,e.showHad.y=commonUtils.StageUtils.getIntance().stage.stageHeight/2;var t=function(){e.removeChild(e.showHad)};e.showHad.addEventListener(egret.Event.COMPLETE,t,e)}e.showHad.parent||e.addChild(e.showHad),e.showHad.animation.gotoAndPlay("tutorialhand"),e.showHad.touchEnabled=e.showHad.touchChildren=!1},t.prototype.enable=function(){e.prototype.enable.call(this),this.rectImg.visible=!1},t.prototype.showPointAndTouch=function(e){this.showHad.visible=e,game.NewControlViewMgr.getIntance().touchEnabledRect=!e},t.prototype.addEvent=function(){this.touchGrp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchUs,this),commonUtils.EventMananger.getIntance().addEvent(commonUtils.GlobalEvent.ClickButton,this.removeUs,this)},t.prototype.showSomeType=function(e){switch(e){case"title":this.addSomeOneOrRemove(this,this.showTitleC,!0);break;case"null":this.addSomeOneOrRemove(this,this.showTitleC,!1)}},t.prototype.touchUs=function(){var t=this;e.prototype.removeUsFromParent.call(this),this.nextStepType&&egret.setTimeout(function(){commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.gamePetConstrolEvent,t.nextStepType)},this,500)},t.prototype.removeEvent=function(){this.touchGrp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchUs,this),commonUtils.EventMananger.getIntance().removeEvent(commonUtils.GlobalEvent.ClickButton,this.removeUs,this)},t.prototype.destroy=function(){},t}(baseContent.BasePanel);e.GamePetControlView=t,__reflect(t.prototype,"game_pet.GamePetControlView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(){var e=t.call(this)||this;e._currentStep=-1,e.stepC={};var n=localStorage.getItem("gamepet_step_control");return n?(e.stepC=JSON.parse(n),e._currentStep=e.stepC.currentStepType):e._currentStep=0,e}return __extends(n,t),n.getIntance=function(){return n._intance||(n._intance=new n),n._intance},Object.defineProperty(n.prototype,"currentStepType",{get:function(){return this._currentStep},set:function(e){this._currentStep=e},enumerable:!0,configurable:!0}),n.prototype.isControlEnd=function(){return this._currentStep<7||!game.GameDatas.getIntance().user_info.in_battle_pet_id?!1:!0},n.prototype.initView=function(){this._usRectTouch=new eui.Group,this.addChild(this._usRectTouch),this.left=this.right=this.top=this.bottom=this._usRectTouch.left=this._usRectTouch.right=this._usRectTouch.top=this._usRectTouch.bottom=0,this._usRectTouch.touchEnabled=!1,this.touchEnabled=!1,baseContent.LayerMgr.getIntance().addChild(this)},Object.defineProperty(n.prototype,"touchEnabledRect",{get:function(){return this._usRectTouch.touchEnabled},set:function(e){this._usRectTouch.touchEnabled=e},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.addEvent(),this._gamePetControlView=new e.GamePetControlView,this.initView()},n.prototype.addControlViewByPointCircle=function(t,n,i,a,o,s,r,h,g){void 0===o&&(o=!0),void 0===s&&(s=!1),void 0===r&&(r=null),void 0===h&&(h=0),void 0===g&&(g="点击任意位置继续");var c=e.GamePetControlViewMgr.getIntance();c.checkIsControl(i)||(c._gamePetControlView.showSomeType("null"),c.currentStepType=i,c._gamePetControlView.nextStepType=a,c._gamePetControlView.touchGrp.visible=c._gamePetControlView.touchGrp.touchEnabled=s,c._gamePetControlView.initShowPointCircle(t,n,o),baseContent.PanelManager.getIntance().addChild(c._gamePetControlView))},n.prototype.addControlViewByPointCircleTypeTitle=function(t,n,i,a,o,s,r,h,g){void 0===o&&(o=!0),void 0===s&&(s=!1),void 0===r&&(r=null),void 0===h&&(h=0),void 0===g&&(g="点击任意位置继续");var c=e.GamePetControlViewMgr.getIntance();c.checkIsControl(i)||(c.currentStepType=i,c._gamePetControlView.nextStepType=a,c._gamePetControlView.touchGrp.visible=c._gamePetControlView.touchGrp.touchEnabled=s,null==g?g="点击任意位置继续":1,c._gamePetControlView.initShowTitle(r,h,g),c._gamePetControlView.initShowPointCircle(t,n,o),baseContent.PanelManager.getIntance().addChild(c._gamePetControlView))},n.prototype.addControlViewByPointRect=function(t,n,i,a,o,s,r,h,g,c,m){void 0===s&&(s=!0),void 0===r&&(r=!1),void 0===h&&(h=null),void 0===g&&(g=0),void 0===c&&(c="点击任意位置继续"),void 0===m&&(m=1);var p=e.GamePetControlViewMgr.getIntance();p.checkIsControl(a)||(p._gamePetControlView.showSomeType("title"),p.currentStepType=a,p._gamePetControlView.nextStepType=o,p._gamePetControlView.initShowPointRect(t,n,i,s,r,m),p._gamePetControlView.touchGrp.visible=p._gamePetControlView.touchGrp.touchEnabled=r,null==c?c="点击任意位置继续":1,p._gamePetControlView.initShowTitle(h,g,c),baseContent.PanelManager.getIntance().addChild(p._gamePetControlView))},n.prototype.addControlViewByPointRectTypeOfPoint=function(t,n,i,a,o,s,r,h,g,c,m,p,l){void 0===h&&(h=!0),void 0===g&&(g=!1),void 0===c&&(c=null),void 0===m&&(m=0),void 0===p&&(p="点击任意位置继续"),void 0===l&&(l=1);var u=e.GamePetControlViewMgr.getIntance();u.checkIsControl(s)||(u._gamePetControlView.showSomeType("title"),u.currentStepType=s,u._gamePetControlView.nextStepType=r,u._gamePetControlView.initShowPointRectTypeOfPoint(t,n,i,a,o,h,g,l),u._gamePetControlView.touchGrp.visible=u._gamePetControlView.touchGrp.touchEnabled=g,null==p?p="点击任意位置继续":1,u._gamePetControlView.initShowTitle(c,m,p),baseContent.PanelManager.getIntance().addChild(u._gamePetControlView))},n.prototype.checkIsControl=function(t){var n=e.GamePetControlViewMgr.getIntance();return n.stepC["control-"+t]?!0:(n.stepC["control-"+t]=!0,n.stepC.currentStepType=t,localStorage.setItem("gamepet_step_control",JSON.stringify(n.stepC)),!1)},n.prototype.addEvent=function(){commonUtils.EventMananger.getIntance().addEvent(game.GameEvent.gamePetConstrolEvent,e.GamePetControlViewMgr.getIntance().gamePetControlOneHandle,e.GamePetControlViewMgr.getIntance())},n.prototype.gamePetControlOneHandle=function(t){if(console.log("显示步骤-->"+t),!e.GamePetControlViewMgr.getIntance().isControlEnd())switch(t){case e.GamePetStepType.haveOneEgg:if(game.GameDatas.getIntance().user_info&&game.GameDatas.getIntance().user_info.in_battle_pet_id>0)return;baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetInfoEggView);break;case e.GamePetStepType.haFeiViewInfo:baseContent.SceneLayerMgr.getIntance().getCurrenScene().initShow(),baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetObjInfoView);break;case e.GamePetStepType.barInfoView:e.GamePetControlViewMgr.getIntance().addControlViewByPointRectTypeOfPoint(new egret.Point(commonUtils.StageUtils.getIntance().stage.stageWidth/2,commonUtils.StageUtils.getIntance().stage.stageHeight/2),210,commonUtils.StageUtils.getIntance().stage.stageHeight-315,380,40,e.GamePetStepType.barInfoView,e.GamePetStepType.yaoShuiViewInfo,!0,!0,[{text:"宠物经验条，每消耗一点",style:{textColor:"0x471D05",size:24}},{text:"能量",style:{textColor:"0xff0000",size:24}},{text:"会增加一点经验，送它",style:{textColor:"0x471D05",size:24}},{text:"青汁",style:{textColor:"0xff0000",size:24}},{text:"可以增长大量经验！",style:{textColor:"0x471D05",size:24}}],190);break;case e.GamePetStepType.yaoShuiViewInfo:e.GamePetControlViewMgr.getIntance().addControlViewByPointCircle(new egret.Point(70,140),65,e.GamePetStepType.yaoShuiViewInfo,null);break;case e.GamePetStepType.chongWuUpInfo:e.GamePetControlViewMgr.getIntance().addControlViewByPointRect(new egret.Point(commonUtils.StageUtils.getIntance().stage.stageWidth/2,commonUtils.StageUtils.getIntance().stage.stageHeight/2),commonUtils.StageUtils.getIntance().stage.stageHeight+80,40,e.GamePetStepType.chongWuUpInfo,e.GamePetStepType.bingGanViewInfo,!0,!0,[{text:"快看！宠物升级了，升级后会提升",style:{textColor:"0x471D05",size:24}},{text:"宠物技能！",style:{textColor:"0xff0000",size:24}}],190);break;case e.GamePetStepType.bingGanViewInfo:if(!game.GameDatas.getIntance().pet_infos||game.GameDatas.getIntance().pet_infos.pet_snacks<1)return;e.GamePetControlViewMgr.getIntance().addControlViewByPointCircleTypeTitle(new egret.Point(70,295),68,e.GamePetStepType.bingGanViewInfo,null,!0,!1,[{text:"宠物在饥饿时不能使用技能，快去让我们喂它",style:{textColor:"0x471D05",size:24}},{text:"吃零食！",style:{textColor:"0xff0000",size:24}}],400);break;case e.GamePetStepType.endViewInfo:e.GamePetControlViewMgr.getIntance().addControlViewByPointRect(new egret.Point(commonUtils.StageUtils.getIntance().stage.stageWidth/2,commonUtils.StageUtils.getIntance().stage.stageHeight/2),commonUtils.StageUtils.getIntance().stage.stageHeight+80,40,e.GamePetStepType.endViewInfo,null,!0,!0,[{text:"以后它会一直陪着你，祝你玩的开心，加油！",style:{textColor:"0x471D05",size:24}}],190)}},n}(eui.UILayer);e.GamePetControlViewMgr=t,__reflect(t.prototype,"game_pet.GamePetControlViewMgr")}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.clickTime=0,t.className_key="GamePetInfoEggView",t.eggPlayEnd=!0,t.skinName="GamePetInfoEggViewSkin",t.showHadC(),t}return __extends(t,e),t.prototype.enable=function(){var t=this;e.prototype.enable.call(this),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType,function(){t.showHad.visible=!0},this)},t.prototype.removeUs=function(){this.showHad.visible=!1,e.prototype.removeUs.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.init=function(){egret.Tween.get(this.guang_img,{loop:!0}).to({rotation:360},3e3),this.showHad.x=commonUtils.StageUtils.getIntance().stage.stageWidth/2,this.showHad.y=commonUtils.StageUtils.getIntance().stage.stageHeight/2,this.initEgg_animation()},t.prototype.initEgg_animation=function(){var e=this;e.egg_animation||(e.egg_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("egg_animation","MovieClip","egg_animation"),e.grpCenter.addChild(e.egg_animation),e.egg_animation.name="egg_animation",e.egg_animation.x=commonUtils.StageUtils.getIntance().stage.stageWidth/2,e.egg_animation.y=800,e.egg_animation.addEventListener(egret.Event.COMPLETE,e.eggAnimationEnd,e)),e.egg_animation.animation.play("shake",1),e.egg_animation.visible=e.egg_animation.touchEnabled=!0,e.iconShow.visible=!1},t.prototype.eggAnimationEnd=function(){var e=this;e.eggPlayEnd=!0,e.keyTimeOut=egret.setTimeout(function(){e.egg_animation.animation.play("shake",1)},e,3e3)},t.prototype.showFuHuaAnimation=function(){var e=this;if(e.eggPlayEnd)switch(e.eggPlayEnd=!1,e.clickTime+=1,e.egg_animation.animation.stop(),egret.clearTimeout(e.keyTimeOut),e.clickTime){case 1:e.egg_animation.animation.play("one",1);break;case 2:e.egg_animation.animation.play("two",1);break;case 3:e.egg_animation.animation.play("three",1);var t=function(){e.egg_animation.removeEventListener(egret.Event.COMPLETE,t,e),game.GameDatas.getIntance().user_info.in_battle_pet_id||(console.log("孵化第一个蛋!"),game.GameRequestMgr.getIntance().Pet_petInit_C()),e.destroy()};e.egg_animation.addEventListener(egret.Event.COMPLETE,t,e)}},t.prototype.addEvent=function(){this.egg_animation.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.touchHandle=function(e){switch(e.target){case this.egg_animation:this.showFuHuaAnimation()}},t.prototype.removeEvent=function(){this.egg_animation.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},t.prototype.showHadC=function(){var e=this;if(!e.showHad){e.showHad=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("a","tutorialhand","tutorialhand"),e.showHad.name="a",e.showHad.x=commonUtils.StageUtils.getIntance().stage.stageWidth/2,e.showHad.y=commonUtils.StageUtils.getIntance().stage.stageHeight/2;var t=function(){e.removeChild(e.showHad)};e.showHad.addEventListener(egret.Event.COMPLETE,t,e),e.showHad.scaleX=-1}e.showHad.parent||e.addChild(e.showHad),e.showHad.animation.gotoAndPlay("tutorialhand"),e.showHad.touchEnabled=e.showHad.touchChildren=!1,e.showHad.visible=!1},t.prototype.destroy=function(){e.prototype.destroy.call(this),egret.Tween.removeTweens(this.guang_img),this.showHad=null},t}(baseContent.BasePanel);e.GamePetInfoEggView=t,__reflect(t.prototype,"game_pet.GamePetInfoEggView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(t){function n(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.className_key="GamePetObjInfoView",n.infos_=e,n.skinName="GamePetObjInfoViewSkin",n}return __extends(n,t),n.prototype.enable=function(){t.prototype.enable.call(this),t.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType)},n.prototype.removeUs=function(){t.prototype.removeUs.call(this,baseContent.PanelMoveType.scaleType)},n.prototype.init=function(){if(this.infos_){switch(this.infos_.petId){case 1:this.iconShow.source="game_pet_img_kuiling_png";break;case 2:this.iconShow.source="game_pet_img_hafei_png"}this.nameStr.text=this.infos_.petName,this.skillInfo.text=this.infos_.skillInfo}egret.Tween.get(this.guang_img,{loop:!0}).to({rotation:360},3e3)},n.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(t){var n=this;switch(t.target){case this.closeBtn:if(this.infos_)return commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.petFuHuaEndEvent,{pet_id:this.infos_.petId}),void this.destroy();commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!0),game.GameRequestMgr.getIntance().Pet_petLists_C(),commonUtils.ResUtils.getInstance().loadGroupByGrpArr([game.GameDatas.game_pet],null,function(){egret.setTimeout(function(){game.GameDatas.getIntance().pet_infos&&baseContent.PanelManager.getIntance().openTypeIntance(e.GamePetView),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowChaoPing,!1),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowMainView,!1),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!1)},n,750)},this),this.destroy()}},n.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.destroy=function(){t.prototype.destroy.call(this),egret.Tween.removeTweens(this.guang_img),game.GameDatas.getIntance().fuhuaPetInfo=null},n}(baseContent.BasePanel);e.GamePetObjInfoView=t,__reflect(t.prototype,"game_pet.GamePetObjInfoView",["baseContent.IObj"])}(game_pet||(game_pet={}));var game_pet;!function(e){var t=function(){function e(){}return e.haveOneEgg=1,e.haFeiViewInfo=2,e.barInfoView=3,e.yaoShuiViewInfo=4,e.chongWuUpInfo=5,e.bingGanViewInfo=6,e.endViewInfo=7,e}();e.GamePetStepType=t,__reflect(t.prototype,"game_pet.GamePetStepType")}(game_pet||(game_pet={}));;window.game_pet = game_pet