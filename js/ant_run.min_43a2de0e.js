var egret = window.egret;var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,a){function r(e){try{l(i.next(e))}catch(t){a(t)}}function s(e){try{l(i["throw"](e))}catch(t){a(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(r,s)}l((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(r=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,a=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(i){n=[6,i],a=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,a,r,s,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},ant_run;!function(e){var t=function(e){function t(t,n){var i=e.call(this)||this;return i.eggPlayEnd=!0,i.petInfoConfig=n,i.petInfo=t,i.skinName="GamePetItemViewSkin",i}return __extends(t,e),Object.defineProperty(t.prototype,"petInfo_",{get:function(){return this.petInfo},set:function(e){this.petInfo=e,this.init()},enumerable:!0,configurable:!0}),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.initEgg_animation(),this.init_iconPet_animation(),this.init(),this.addEvent()},t.prototype.init=function(){this.index=0,this.initShow(this.petInfo),this.msgGrp.visible=!1},t.prototype.init_iconPet_animation=function(){var e=this;if(!e.iconPet_animation){e.iconPet_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation(e.petInfoConfig.source,"Armature",e.petInfoConfig.source),e.allGrp.addChild(e.iconPet_animation),e.iconPet_animation.name="iconPet_animation",e.iconPet_animation.x=this.allGrp.width/2,e.iconPet_animation.y=570;var t=function(){e.playPetAnimationAction("daily")};e.iconPet_animation.addEventListener(egret.Event.COMPLETE,t,e)}e.iconPet_animation.visible=!1},t.prototype.initEgg_animation=function(){var e=this;e.egg_animation||(e.egg_animation=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation("egg_animation","MovieClip","egg_animation"),e.allGrp.addChild(e.egg_animation),e.egg_animation.name="egg_animation",e.egg_animation.x=this.allGrp.width/2,e.egg_animation.y=600,e.egg_animation.addEventListener(egret.Event.COMPLETE,e.eggAnimationEnd,e)),e.egg_animation.animation.play("shake",1),e.egg_animation.visible=!1,e.egg_animation.touchEnabled=!0},t.prototype.eggAnimationEnd=function(){var e=this;e.eggPlayEnd=!0,e.keyTimeOut=egret.setTimeout(function(){e.egg_animation.animation.play("shake",1)},e,3e3)},t.prototype.initShow=function(e){var t=this;e&&(t.petInfo=e,0==t.petInfo.hatch_status?(t.iconPet_animation.visible=!1,t.egg_animation.visible=!0):(t.playPetAnimationAction("daily"),t.iconPet_animation.visible=!0,t.egg_animation.visible=!1))},t.prototype.playPetAnimationAction=function(e){var t=this;t.iconPet_animation.animation.isPlaying&&t.iconPet_animation.animation.stop(),t.iconPet_animation.animation.play(e,1)},t.prototype.addEvent=function(){},t}(eui.Component);e.AntRunPetItemView=t,__reflect(t.prototype,"ant_run.AntRunPetItemView")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(){function t(){this.pools=new commonUtils.ObjectPoolTool("ant_run.AntRunBoxCom")}return t.getInstance=function(){return e.AntRunBoxFactory.intance_||(e.AntRunBoxFactory.intance_=new e.AntRunBoxFactory),e.AntRunBoxFactory.intance_},t.prototype.pullOneBox=function(){return this.pools.getObject()},t.prototype.pushOneBox=function(e){this.pools.returnObject(e)},t.prototype.getSomeBoxConfigs=function(e,t,n){var i=[0,1,2,3];if(n>4&&(n=4),"auto"==t){for(var o=["antHead","music","balary","cannon"],a=[],r=0;n>r;r++){var s=Math.floor(Math.random()*i.length),l=i[s];if(0==r)t="gold";else{var u=Math.floor(Math.random()*o.length);t=o[u],o.splice(u,1)}var c={color:e,icon:t,localIndex:l};i.splice(s,1),a.push(c)}return a}for(var g=[],r=0;n>r;r++){var s=Math.floor(Math.random()*i.length),l=i[s],c={color:e,icon:t,localIndex:l};i.splice(s,1),g.push(c)}return g},t}();e.AntRunBoxFactory=t,__reflect(t.prototype,"ant_run.AntRunBoxFactory")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.className_key="AntRunPetListView",e.isCreate=!1,e.petInfos=[{id:1,name:"奎林",icon:"game_pet_img_kuiling_png",nameStr:"game_pet_tex_json.game_pet_text_kuiling_png",source:"kuilin_animation",info:""},{id:2,name:"哈菲",icon:"game_pet_img_hafei_png",nameStr:"game_pet_tex_json.game_pet_text_hafei_png",source:"hafei_animation",info:""}],e.indexSelect=0,e.skinName="AntRunPetListViewSkin",e}return __extends(n,t),n.prototype.init=function(){this.isCreate=!0},n.prototype.initShowSomePet=function(){var t=this;if(t.isCreate){t.textImg.source=t.petInfos[t.indexSelect].nameStr;for(var n=game.GameDatas.getIntance().Ant_RunInfo,i=0,o=n.pet_list.length;o>i;i++){var a=void 0;i<t.listGrp.numChildren?(a=t.listGrp.getChildAt(i),a.initShow(n.pet_list[i])):(a=new e.AntRunPetItemView(n.pet_list[i],t.petInfos[i]),t.listGrp.addChild(a)),a.horizontalCenter=700*i,a.verticalCenter=-45}t.keyNumLab.text="钥匙："+n.key+"/"+n.game_setting.expend_keys,t.getBtn.visible=!1,t.openBtn.visible=!0,t.topHistory(n.pet_list[t.indexSelect])}},n.prototype.topHistory=function(e){var t=this;0==e.hatch_status?(t.getBtn.visible=!0,t.getBtn.touchChildren=!1,t.openBtn.visible=!1,t.keyG.visible=!1):(t.getBtn.visible=!1,t.openBtn.visible=!0,t.keyG.visible=!0),t.highestShow(e.distance),t.getAddMaiMiaoLab.text=e.skill_descript_run},n.prototype.highestShow=function(e){var t,n=[];t=e>0?""+e:"暂无数据",n=[{text:"历史最高: ",style:{size:24,textColor:"0x7C390C",fontFamily:"Microsoft YaHei"}},{text:t,style:{size:24,textColor:"0xFF3046",fontFamily:"Microsoft YaHei"}}],this.msgTop.textFlow=n},n.prototype.enable=function(){t.prototype.enable.call(this),this.rectImg.visible=!1,this.initShowSomePet()},n.prototype.addEvent=function(){this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.openBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(e){var t=this,n=game.GameDatas.getIntance().Ant_RunInfo;switch(e.target){case this.openBtn:0!=n.pet_list[this.indexSelect].hatch_status?(console.log("使用宠物 ID:"+n.pet_list[this.indexSelect]),n.key>=n.game_setting.expend_keys?game.GameRequestMgr.getIntance().AntRun_enterGame_C(n.pet_list[this.indexSelect].pet_id):viewTool.TipsUtil.getIntance().showTip("钥匙不足")):viewTool.TipsUtil.getIntance().showTip("宠物尚未孵化");break;case this.backBtn:commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!0),egret.setTimeout(function(){commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowChaoPing,!0),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.CloseShowMainView,!0),commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.MiwuZheDangEvent,!1),t.removeUsFromParent()},this,750);break;case this.leftBtn:this.changeScrllView(!1);break;case this.rightBtn:this.changeScrllView(!0);break;case this.getBtn:commonUtils.EventMananger.getIntance().sendEvent(game.GameEvent.enterPetView),egret.setTimeout(function(){t.removeUsFromParent()},this,750)}},n.prototype.changeScrllView=function(e){var t=game.GameDatas.getIntance().Ant_RunInfo;e?(this.indexSelect+=1,this.indexSelect==this.petInfos.length-1?this.rightBtn.enabled=!1:this.rightBtn.enabled=!0,this.indexSelect>0&&(this.leftBtn.enabled=!0)):(this.indexSelect-=1,0==this.indexSelect?this.leftBtn.enabled=!1:this.leftBtn.enabled=!0,this.indexSelect<this.petInfos.length&&(this.rightBtn.enabled=!0)),egret.Tween.get(this.scrollerView.viewport).to({scrollH:700*this.indexSelect},300,egret.Ease.sineIn),this.textImg.source=this.petInfos[this.indexSelect].nameStr,this.topHistory(t.pet_list[this.indexSelect])},n.prototype.removeEvent=function(){this.leftBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.rightBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n}(baseContent.BasePanel);e.AntRunPetListView=t,__reflect(t.prototype,"ant_run.AntRunPetListView")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(t){function n(e){void 0===e&&(e="green");var n=t.call(this)||this;return n.nomoralArr=0,n.maxBoxNum=6,n.index=0,n.bgColor=e,n.touchEnabled=!1,n.touchChildren=!1,n.bgLayer=new egret.Sprite,n.boxLayer=new egret.Sprite,n.addChild(n.bgLayer),n.addChild(n.boxLayer),n.init(),n}return __extends(n,t),Object.defineProperty(n.prototype,"BoxArrs",{get:function(){return this.boxArrs},set:function(e){this.boxArrs=e},enumerable:!0,configurable:!0}),n.prototype.init=function(){this.initBgs(),this.addBoxs()},n.prototype.initBgs=function(){if(!this.bgs){this.bgs=[];var e=1072,t=new egret.Bitmap;t.texture=RES.getRes("mayikuaipao_"+this.bgColor+"_bg_png"),t.y=commonUtils.StageUtils.getIntance().stage.stageHeight-e,this.bgLayer.addChild(t),this.bgs.push(t);var n=new egret.Bitmap;n.texture=RES.getRes("mayikuaipao_"+this.bgColor+"_bg_png"),n.y=commonUtils.StageUtils.getIntance().stage.stageHeight-2*e,this.bgLayer.addChild(n),this.bgs.push(n);var i=new egret.Bitmap;i.texture=RES.getRes("mayikuaipao_"+this.bgColor+"_bg_png"),i.y=commonUtils.StageUtils.getIntance().stage.stageHeight-3*e,this.bgLayer.addChild(i),this.bgs.push(i)}},n.prototype.addBoxs=function(){var t=this;t.boxArrs=[];var n=new e.AntRunBoxArrSpr([{color:this.bgColor,icon:"null",localIndex:0},{color:this.bgColor,icon:"null",localIndex:1},{color:this.bgColor,icon:"null",localIndex:2},{color:this.bgColor,icon:"null",localIndex:3}]);n.y=commonUtils.StageUtils.getIntance().stage.stageHeight-n.height,t.boxArrs.push(n),t.boxLayer.addChild(n),this.nomoralArr++;for(var i=0;i<this.maxBoxNum-1;i++)if(!this.checkBlockSetting()){var o=new e.AntRunBoxArrSpr([{color:this.bgColor,icon:"gold",localIndex:i%4}]);o.y=-268+t.boxArrs[t.boxArrs.length-1].y,t.boxArrs.push(o),t.boxLayer.addChild(o),this.nomoralArr++}},n.prototype.runBgs=function(){var e=this,t=268;if(e.moveTweenBoxs){if(egret.Tween.removeTweens(e.bgLayer),e.bgLayer.y=e.index*t,egret.Tween.removeTweens(e.boxLayer),e.boxLayer.y=e.index*t,e.index%4==0){var n=e.bgs.shift();n.y=-1072+e.bgs[e.bgs.length-1].y,e.bgs.push(n)}var i=e.boxArrs.shift();i.y=-268+e.boxArrs[e.boxArrs.length-1].y,e.boxArrs.push(i)}var o=125;e.index++,egret.Tween.get(e.bgLayer).to({y:e.index*t},o,egret.Ease.sineOut).call(function(){if(e.moveTweenBoxs=null,e.index%4==0){var t=e.bgs.shift();t.y=-1072+e.bgs[e.bgs.length-1].y,e.bgs.push(t)}}),e.moveTweenBoxs=egret.Tween.get(e.boxLayer).to({y:e.index*t},o,egret.Ease.sineOut).call(function(){var t=e.boxArrs.shift();if(t.IsSpecial||e.nomoralArr++,!e.checkBlockSetting(t)){if(e.boxArrs.length>e.maxBoxNum)return t.destory(),void(t.IsSpecial||e.nomoralArr--);t.y=-268+e.boxArrs[e.boxArrs.length-1].y,e.boxArrs.push(t),t.changeData([{color:e.bgColor,icon:"gold",localIndex:Math.floor(Math.random()*[0,1,2,3].length)}]);var n=baseContent.PanelManager.getIntance().getPenelByPanelKey("AntRunView");if(n)for(var i=void 0,o=0,a=e.boxArrs[0].Boxs.length;a>o;o++)e.boxArrs[0].Boxs[o].BoxConfig.localIndex==n.Player.LocalIndex&&(i=e.boxArrs[0].Boxs[o])}},e)},n.prototype.checkBlockSetting=function(t){void 0===t&&(t=null);var n=this;if(this.nomoralArr>0&&this.nomoralArr%(e.AntRunView.block_setting.step+1)==0&&(this.nomoralArr=0,Math.random()<=e.AntRunView.block_setting.rate)){var i=this.bgColor,o=["green","blue","pink"];o.splice(o.indexOf(i),1),i=o[Math.floor(Math.random()*o.length)],t||(t=new e.AntRunBoxArrSpr,n.boxLayer.addChild(t)),t.y=-268+n.boxArrs[n.boxArrs.length-1].y,n.boxArrs.push(t);var a=e.AntRunView.block_setting.side_num[Math.floor(Math.random()*e.AntRunView.block_setting.side_num.length)],r=e.AntRunBoxFactory.getInstance().getSomeBoxConfigs(i,"auto",a);t.changeData(r);for(var s=1,l=e.AntRunView.block_setting.series_num;l>s;s++){a=e.AntRunView.block_setting.side_num[Math.floor(Math.random()*e.AntRunView.block_setting.side_num.length)];var u=e.AntRunBoxFactory.getInstance().getSomeBoxConfigs(i,"auto",a),c=new e.AntRunBoxArrSpr(u);c.y=-268+n.boxArrs[n.boxArrs.length-1].y,n.boxArrs.push(c),n.boxLayer.addChild(c)}return!0}return!1},n}(egret.Sprite);e.AntRunBgView=t,__reflect(t.prototype,"ant_run.AntRunBgView")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(t){function n(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.isSpecial=!1,n.boxConfigs=e,n.width=720,n.height=268,n.boxs=[],n.init(),n}return __extends(n,t),Object.defineProperty(n.prototype,"IsSpecial",{get:function(){return this.isSpecial},set:function(e){this.isSpecial=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Boxs",{get:function(){return this.boxs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"BoxConfigs",{get:function(){return this.boxConfigs},set:function(e){this.boxConfigs=e},enumerable:!0,configurable:!0}),n.prototype.init=function(){if(this.boxConfigs){if(this.boxs.length>0){for(var t=0,n=this.boxs.length;n>t;t++){var i=this.boxs[t];this.removeChild(i),e.AntRunBoxFactory.getInstance().pushOneBox(i)}this.boxs=[]}for(var t=0,n=this.boxConfigs.length;n>t;t++){var i=e.AntRunBoxFactory.getInstance().pullOneBox();i.changeData(this.boxConfigs[t]),i.x=this.boxConfigs[t].localIndex*i.width,this.boxs.push(i),this.addChild(i)}}},n.prototype.changeData=function(e){this.boxConfigs=e,this.init()},n.prototype.destory=function(){if(this.parent&&this.parent.removeChild(this),this.boxs.length>0){for(var t=0,n=this.boxs.length;n>t;t++){var i=this.boxs[t];this.removeChild(i),e.AntRunBoxFactory.getInstance().pushOneBox(i)}this.boxs=[]}this.boxs=null,this.boxConfigs=null,this.isSpecial=null},n}(egret.Sprite);e.AntRunBoxArrSpr=t,__reflect(t.prototype,"ant_run.AntRunBoxArrSpr")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.width=180,t.height=268,t.bg=new egret.Bitmap,t.addChild(t.bg),t.bg.name="bg",t.iconBuff=new egret.Bitmap,t.addChild(t.iconBuff),t.iconBuff.name="icon",t}return __extends(t,e),Object.defineProperty(t.prototype,"BoxConfig",{get:function(){return this.boxConfig},enumerable:!0,configurable:!0}),t.prototype.init=function(){switch(this.bg.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_"+this.boxConfig.color+"_kawei_png"),this.bg.x=(this.width-172)/2,this.bg.y=(this.height-243)/2,this.iconBuff.visible=!0,this.boxConfig.icon){case"antHead":this.iconBuff.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_"+this.boxConfig.color+"_mayi_png");break;case"music":this.iconBuff.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_"+this.boxConfig.color+"_music_png");break;case"balary":this.iconBuff.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_"+this.boxConfig.color+"_xiaomai_png");break;case"gold":this.iconBuff.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_end_$_png");break;case"cannon":this.iconBuff.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_"+this.boxConfig.color+"_dapao_png");break;case"null":this.iconBuff.visible=!1}this.iconBuff.visible&&(this.iconBuff.x=(this.width-this.iconBuff.texture.textureWidth)/2,this.iconBuff.y=(this.height-this.iconBuff.texture.textureHeight)/2-10)},t.prototype.changeData=function(e){this.boxConfig=e,this.init()},t.configWidth=180,t.configHeight=268,t}(egret.Sprite);e.AntRunBoxCom=t,__reflect(t.prototype,"ant_run.AntRunBoxCom");var n=function(){function e(){}return e}();e.BoxConfig=n,__reflect(n.prototype,"ant_run.BoxConfig")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.className_key="AntRunEndView",n.configData=t,n.skinName="AntRunEndViewSkin",n}return __extends(t,e),t.prototype.init=function(){this.initShow()},t.prototype.initShow=function(){var e=this;e.coinLab.text=""+this.configData.gold,e.miLab.text=""+this.configData.mi;var t=[];t=[{text:"最高连击: ",style:{bold:!0,textColor:"0xFFFFFF",fontFamily:"Tensentype-",strokeColor:"0xD78709",stroke:"2"}},{text:""+this.configData.mxContinueStep,style:{bold:!0,textColor:"0xFF4800",fontFamily:"Tensentype-",strokeColor:"0xEDC515",stroke:"2"}}],e.topHitLab.textFlow=t},t.prototype.enable=function(){e.prototype.enable.call(this),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType,this.initShow)},t.prototype.addEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sureClick,this)},t.prototype.sureClick=function(){this.destroy(),game.GameRequestMgr.getIntance().AntRun_init_C(),baseContent.PanelManager.getIntance().removeSomeOnePanel("AntRunView")},t.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sureClick,this)},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(baseContent.BasePanel);e.AntRunEndView=t,__reflect(t.prototype,"ant_run.AntRunEndView")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className_key="AntRunDaoJiShi",t}return __extends(t,e),t.prototype.init=function(){},t.prototype.enable=function(){e.prototype.enable.call(this),e.prototype.showEnter.call(this,baseContent.PanelMoveType.scaleType)},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t}(baseContent.BasePanel);e.AntRunDaoJiShi=t,__reflect(t.prototype,"ant_run.AntRunDaoJiShi")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.status="stop",e.width=180,e.height=268,e.init(),e}return __extends(n,t),n.prototype.runToIndex=function(t,n){var i=this;return i.runMoveTween?i.runMoveTween:(egret.Tween.removeTweens(i.deffetImg),i.deffetImg.parent&&i.deffetImg.parent.removeChild(i.deffetImg),i.reLifeImg.visible=!1,n?(i.runMoveTween=egret.Tween.get(i).to({x:t*i.width,y:i.y-.5*e.AntRunBoxCom.configHeight},60,egret.Ease.sineIn).to({y:i.y},60,egret.Ease.sineIn).call(function(){i.runMoveTween=null},i),i.localIndex=t,null):(i.runMoveTween=egret.Tween.get(i).to({x:t*i.width,y:i.y-.5*e.AntRunBoxCom.configHeight},125,egret.Ease.sineIn).call(i.showDeffetImg,i).to({x:i.localIndex*i.width,y:i.y},125,egret.Ease.sineIn).call(function(){i.runMoveTween=null,i.reLifeImg.visible=!0,egret.setTimeout(function(){i.reLifeImg.visible=!1},i,300)},i),null))},n.prototype.showDeffetImg=function(){var t=this,n=new egret.Point;n=t.parent.localToGlobal(t.x,t.y,n),t.deffetImg.x=n.x+(e.AntRunBoxCom.configWidth-162)/2,t.deffetImg.y=commonUtils.StageUtils.getIntance().stage.stageHeight-2*e.AntRunBoxCom.configHeight+(e.AntRunBoxCom.configHeight-240)/2;var i=baseContent.PanelManager.getIntance().getPenelByPanelKey("AntRunView");i.addChild(t.deffetImg),egret.Tween.get(t.deffetImg).wait(1e3).call(function(){t.deffetImg.parent&&t.deffetImg.parent.removeChild(t.deffetImg)},t)},Object.defineProperty(n.prototype,"LocalIndex",{get:function(){return this.localIndex},set:function(e){this.localIndex=e,this.x=e*this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Status",{get:function(){return this.status},set:function(e){this.display.animation.stop(),this.display.animation.play(e,1)},enumerable:!0,configurable:!0}),n.prototype.init=function(){var e=this;e.deffetImg||(e.deffetImg=new egret.Bitmap,e.deffetImg.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_error_png")),e.reLifeImg||(e.reLifeImg=new egret.Bitmap,e.reLifeImg.texture=RES.getRes("mayi_kuaipao_json.mayikuaipao_restart_png"),e.addChild(e.reLifeImg),e.reLifeImg.x=-50,e.reLifeImg.visible=!1)},n.prototype.initShowDisplay=function(e){var t=this;t.playerName!=e&&(t.playerName=e,t.display&&(t.display.parent.removeChild(t.display),t.display.removeEventListener(egret.Event.COMPLETE,t.playLvUpAnimationEnd,t),t.display=null),t.display=viewTool.GameSomeAnimationUitl.getSomeDroBoneAnimation(t.playerName+"jump_animation","MovieClip",t.playerName+"jump_animation"),t.addChild(t.display),t.display.name=t.playerName+"jump_animation",t.display.x=t.width/2,t.display.y=t.height-60,t.display.addEventListener(egret.Event.COMPLETE,t.playLvUpAnimationEnd,t),t.display.animation.play(t.status,1))},n.prototype.playLvUpAnimationEnd=function(){this.display.animation.play(this.status,1)},n.prototype.changeData=function(){},n}(egret.Sprite);e.AntRunPlayer=t,__reflect(t.prototype,"ant_run.AntRunPlayer")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(t){function n(){var n=t.call(this)||this;n.className_key="AntRunView",n.gameTimeNum_=60,n.showCombolNum=3,n.pet_id=1,n.stepNum=0,n.continueStep=0,n.maxContinueStep=0;var i=n;switch(Math.floor(3*Math.random())){case 0:i.ant_runBgView=new e.AntRunBgView("green");break;case 1:i.ant_runBgView=new e.AntRunBgView("blue");break;case 2:i.ant_runBgView=new e.AntRunBgView("pink")}return i.addChild(i.ant_runBgView),i.player=new e.AntRunPlayer,i.addChild(i.player),n}return __extends(n,t),Object.defineProperty(n.prototype,"gameTimeNum",{get:function(){return this.gameTimeNum_},set:function(e){this.gameTimeNum_=e,this.headView&&(this.headView.time=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HeadView",{get:function(){return this.headView},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Player",{get:function(){return this.player},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MaxContinueStep",{get:function(){return this.maxContinueStep},set:function(e){this.maxContinueStep=e},enumerable:!0,configurable:!0}),n.prototype.init=function(){var t=this;t.headView=new e.AntRunViewHead,t.addChild(t.headView),t.headView.horizontalCenter=0,t.headView.top=0,t.combolView=new e.AntRunViewCombol,t.addChild(t.combolView),t.combolView.x=t.combolView.anchorOffsetX+17,t.combolView.y=t.combolView.anchorOffsetY+306,t.combolView.visible=!1,t.lastTimeNum=new eui.BitmapLabel,t.lastTimeNum.font="ant_run_last_font_fnt",t.lastTimeNum.text="a",t.lastTimeNum.horizontalCenter=0,t.lastTimeNum.verticalCenter=0,t.lastTimeNum.visible=!1,t.addChild(t.lastTimeNum),t.touchChildren=!1,t.addEvent(),t.startGame()},n.prototype.initNewControlView=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return t=this,[2,new Promise(function(n){t.newControlView_=new game.NewControlView,baseContent.PanelManager.getIntance().openPanelInstance(t.newControlView_);var i=t.ant_runBgView.BoxArrs[1].Boxs[0],o=new egret.Point;o=i.parent.localToGlobal(i.x,i.y,o);var a=new e.AntRunBoxCom;a.changeData(i.BoxConfig),t.newControlView_.initShowObjRect(o,a,!0,!1),t.newControlView_.touchGrp.visible=t.newControlView_.touchGrp.touchEnabled=!1,t.newControlView_.initShowTitle([{text:"逐个",style:{textColor:"0x471D05",size:24}},{text:"点击方块",style:{textColor:"0xff0000",size:24}},{text:"向前推进，不能",style:{textColor:"0x471D05",size:24}},{text:"点击无方块的地方",style:{textColor:"0xff0000",size:24}},{text:"或者跨越点击！",style:{textColor:"0x471D05",size:24}}],271,"点击任意位置继续"),e.AntRunView.gameIsFirstCompelet="true",localStorage.setItem("gameIsFirstCompelet",e.AntRunView.gameIsFirstCompelet)})]})})},n.prototype.enable=function(){t.prototype.enable.call(this),baseContent.PanelManager.getIntance().removeSomeOnePanel("AntRunPetListView");var e=this,n=Math.random();n>=.6666?game.GameSoundMgr.playBgMusic(!0,"ant_run_gameBgMusic0_mp3"):n>=.3333?game.GameSoundMgr.playBgMusic(!0,"ant_run_gameBgMusic1_mp3"):game.GameSoundMgr.playBgMusic(!0,"ant_run_gameBgMusic2_mp3"),e.touchEnabled=!0;var i=Math.floor(4*Math.random());e.player.LocalIndex=i,e.player.y=commonUtils.StageUtils.getIntance().stage.stageHeight-e.player.height;var o=game.GameDatas.getIntance().getResNameByPetId(e.pet_id);e.player.initShowDisplay(o),e.headView&&(e.headView.gold=0,e.headView.mi=0,e.headView.time=60,e.continueStep=e.maxContinueStep=0,e.stepNum=0)},n.prototype.startGame=function(){var t=this;t.headView.time=t.gameTimeNum;var n=3;t.setLastTimeText(n+""),t.lastTimeNum.font="ant_run_first_font_fnt",egret.Tween.get(t.lastTimeNum).to({scaleY:1.3,scaleX:1.3},100,egret.Ease.backInOut).to({scaleY:1,scaleX:1},100,egret.Ease.backInOut),t.lastTimeNum.visible=!0,t.touchEnabled=!1,game.GameSoundMgr.playSomeSound("ant_run_lastTimeing_mp3"),t.gameTimer=egret.setInterval(function(){return n--,0>=n?(t.gameTimer&&egret.clearInterval(t.gameTimer),game.GameSoundMgr.playSomeSound("ant_run_lastTimeEnd_mp3"),e.AntRunView.gameIsFirstCompelet?t.newControlView_&&(t.newControlView_.destroy(),t.newControlView_=null):t.initNewControlView(),t.setLastTimeText(n+""),t.startTime(),t.lastTimeNum.visible=!0,void(t.touchEnabled=!0)):(t.setLastTimeText(n+""),void game.GameSoundMgr.playSomeSound("ant_run_lastTimeing_mp3"))},t,1e3)},n.prototype.setLastTimeText=function(e){var t=this;t.lastTimeNum.visible=!0,t.lastTimeNum.text=e+"",egret.Tween.get(t.lastTimeNum).to({scaleY:1.3,scaleX:1.3},100,egret.Ease.backInOut).to({scaleY:1,scaleX:1},100,egret.Ease.backInOut).wait(300).call(function(){t.lastTimeNum.visible=!1},t)},n.prototype.startTime=function(){var e=this;e.gameTimer&&egret.clearInterval(e.gameTimer),e.gameTimer=egret.setInterval(function(){return e.gameTimeNum--,e.gameTimeNum<=0?(e.gameTimeNum=0,e.setLastTimeText(e.gameTimeNum+""),e.headView.time=e.gameTimeNum,egret.clearInterval(e.gameTimer),console.log("游戏时间到！"),egret.Tween.get(e.lastTimeNum).to({scaleY:1.3,scaleX:1.3},100,egret.Ease.backInOut).to({scaleY:1,scaleX:1},100,egret.Ease.backInOut),game.GameSoundMgr.playSomeSound("ant_run_lastTimeEnd_mp3"),e.touchEnabled=!1,void game.GameRequestMgr.getIntance().AntRun_gameOver_C()):(e.gameTimeNum<=10&&(e.lastTimeNum.font="ant_run_last_font_fnt",e.lastTimeNum.visible=!0,10==e.gameTimeNum?e.setLastTimeText("a"):e.setLastTimeText(e.gameTimeNum+""),egret.Tween.get(e.lastTimeNum).to({scaleY:1.3,scaleX:1.3},100,egret.Ease.backInOut).to({scaleY:1,scaleX:1},100,egret.Ease.backInOut),e.gameTimeNum>0&&game.GameSoundMgr.playSomeSound("ant_run_lastTimeing_mp3")),void(e.headView.time=e.gameTimeNum))},e,1e3)},n.prototype.reconnectEventHandle=function(){this.parent&&game.GameServerMgr.getIntance().isOpen&&(console.log("服务重联"),game.GameRequestMgr.getIntance().AntRun_reconnect_C())},n.prototype.addEvent=function(){commonUtils.EventMananger.getIntance().addEvent(game.GameServerMgr.serverOpenEvent,this.reconnectEventHandle,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.touchHandle=function(t){var n=this;if(t.stageY<=commonUtils.StageUtils.getIntance().stage.stageHeight-e.AntRunBoxCom.configHeight){var i=Math.floor(t.stageX/e.AntRunBoxCom.configWidth);n.player.LocalIndex<i?n.player.Status="xiangyou":n.player.LocalIndex>i?n.player.Status="xiangzuo":0!=n.player.index?(n.player.index=0,n.player.Status="zuo"):(n.player.index=1,n.player.Status="you");var o=n.checkOk(i);o.isDown||(n.continueStep=0);var a=n.player.runToIndex(i,o.isDown);o.isDown&&!a&&(n.stepNum++,n.continueStep++,n.maxContinueStep<n.continueStep&&(n.maxContinueStep=n.continueStep),n.ant_runBgView.runBgs(),commonUtils.EventMananger.getIntance().sendEvent(commonUtils.GlobalEvent.ClickButton),n.resBoxShow(o.localBox),game.GameRequestMgr.getIntance().AntRun_skipBlock_C(n.pet_id,o.localBox.BoxConfig.icon,n.maxContinueStep),"gold"==o.localBox.BoxConfig.icon&&game.GameSoundMgr.playSomeSound("ant_run_gold_mp3",.6),game.GameSoundMgr.playSomeSound("panel_open_mp3",.7)),n.continueStep>=n.showCombolNum?(n.combolView.Combol=n.continueStep,n.combolView.visible=!0):n.combolView.visible=!1}},n.prototype.resBoxShow=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return t=this,t.flyGoldQueue||(t.flyGoldQueue=new Queue),[2,new Promise(function(n){if(e)switch(e.BoxConfig.icon){case"gold":var i=new egret.Point,o=e.getChildByName("icon");if(o.visible=!1,i=o.parent.localToGlobal(o.x+o.width/2,o.y,i),i.y=commonUtils.StageUtils.getIntance().stage.stageHeight-270,!t.toPoint){var a=t.headView.getChildByName("goldIcon"),r=new egret.Point(130,65);a&&a.parent&&(r=a.parent.localToGlobal(a.x+a.width/2,a.y+a.height/2,r)),t.toPoint=r}var s=t.flyGoldQueue.pull();s||(s=viewTools.GameSomeAnimationUitl.getSomeDroBoneAnimation("goldzhuan_animation","Armature","goldzhuan_animation"),s.name="gold_fly_animation",s.animation.play("newAnimation")),t.showSomeOneToFly(i,t.toPoint,s)}})]})})},n.prototype.showSomeOneToFly=function(e,t,n){var i=this;n.x=e.x,n.y=e.y,i.addChild(n),egret.Tween.get(n).to({scaleX:2,scaleY:2},200).to({scaleX:1,scaleY:1},200),egret.Tween.get(n).to({x:t.x,y:t.y},500,egret.Ease.sineIn).call(function(){egret.Tween.removeTweens(n),n.parent&&n.parent.removeChild(n),n instanceof dragonBones.EgretArmatureDisplay&&i.flyGoldQueue.put(n)})},n.prototype.checkOk=function(e){for(var t=this.ant_runBgView.BoxArrs[1],n=0,i=t.BoxConfigs.length;i>n;n++)if(t.BoxConfigs[n].localIndex==e)return{isDown:!0,localBox:t.Boxs[n]};return{isDown:!1,localBox:null}},n.prototype.removeUsFromParent=function(){game.GameRequestMgr.getIntance().AntRun_init_C(),baseContent.PanelManager.getIntance().openTypeIntance(e.AntRunPetListView),t.prototype.removeUsFromParent.call(this),game.GameSoundMgr.playBgMusic(!0)},n.prototype.removeEvent=function(){commonUtils.EventMananger.getIntance().removeEvent(game.GameServerMgr.serverOpenEvent,this.reconnectEventHandle,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandle,this)},n.prototype.destroy=function(){t.prototype.destroy.call(this)},n.block_setting={step:2,rate:1,side_num:[4],series_num:2},n.gameIsFirstCompelet=localStorage.getItem("gameIsFirstCompelet"),n}(baseContent.BasePanel);e.AntRunView=t,__reflect(t.prototype,"ant_run.AntRunView")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.combol=0,t.width=660,t.height=90,t.anchorOffsetX=t.width/3,t.anchorOffsetY=t.height/2,t.skinName="AntRunViewCombolSkin",t}return __extends(t,e),Object.defineProperty(t.prototype,"Combol",{get:function(){return this.combol},set:function(e){this.combol=e,this.cNum.text=""+e,this.cNum.scaleX=this.cNum.scaleY=1,egret.Tween.get(this.cNum).to({scaleY:1.3,scaleX:1.3},50,egret.Ease.backInOut).to({scaleY:1,scaleX:1},50,egret.Ease.backInOut)},enumerable:!0,configurable:!0}),t.prototype.c=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){this.Combol=3},t.prototype.enable=function(){},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t.prototype.destroy=function(){},t}(eui.Component);e.AntRunViewCombol=t,__reflect(t.prototype,"ant_run.AntRunViewCombol")}(ant_run||(ant_run={}));var ant_run;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.gold_=0,t.time_=0,t.mi_=0,t.skinName="AntRunViewHeadSkin",t}return __extends(t,e),Object.defineProperty(t.prototype,"gold",{get:function(){return this.gold_},set:function(e){this.gold_=e,this.goldText.text=""+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this.time_
},set:function(e){this.time_=e,this.timeText.text=commonUtils.NumberTool.getShowTime(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mi",{get:function(){return this.mi_},set:function(e){this.mi_=e,this.miText.text=e+""},enumerable:!0,configurable:!0}),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){this.gold=0,this.mi=0,this.time=60,commonUtils.DeviceUtils.getInstance().getIsIPhoneX()&&(this.headGrp.top=50)},t.prototype.enable=function(){},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t.prototype.destroy=function(){},t}(eui.Component);e.AntRunViewHead=t,__reflect(t.prototype,"ant_run.AntRunViewHead")}(ant_run||(ant_run={}));;window.ant_run = ant_run